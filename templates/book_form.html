{% block book_content %}
    <!-- Форма добавления/редактирования книги -->
    <form method="POST" action="{{ form_action }}" enctype="multipart/form-data">
        <label for="title">Название:</label>
        <input type="text" name="title" id="title" value="{{ book.title if book else '' }}" required><br>

        <label for="description">Описание:</label>
        <textarea name="description" id="description">{{ book.description if book else '' }}</textarea><br>
        <script>
            const easyMDE = new EasyMDE({
                element: document.getElementById('description'),
                lineWrapping: true,
                previewRender: function (plainText) {
                    // Просто возвращаем исходный текст без преобразования в теги
                    return plainText;
                }
            });
        </script>

        <label for="year">Год издания:</label>
        <input type="number" name="year" id="year" value="{{ book.year if book else '' }}" min="1700" max="{{ current_year }}" required><br>

        <label for="publisher">Издательство:</label>
        <input type="text" name="publisher" id="publisher" value="{{ book.publisher if book else '' }}" required><br>

        <label for="author">Автор:</label>
        <input type="text" name="author" id="author" value="{{ book.author if book else '' }}" required><br>

        <label for="pages">Количество страниц:</label>
        <input type="number" name="pages" id="pages" value="{{ book.pages if book else '' }}" required><br>

        {% if add_mode %}
            <label for="cover">Обложка:</label>
            <input type="file" name="cover" id="cover" required><br>
        {% endif %}

        <label for="genres">Жанры:</label>
        <select name="genres" id="genres" multiple required>
            {% for genre in genres %}
                <option value="{{ genre.id }}" {% if book and genre in book.genres %}selected{% endif %}>{{ genre.name }}</option>
            {% endfor %}
        </select><br>

        <input type="submit" value="Сохранить">
    </form>
{% endblock %}